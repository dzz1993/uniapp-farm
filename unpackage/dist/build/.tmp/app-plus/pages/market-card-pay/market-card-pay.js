(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/market-card-pay/market-card-pay"],{"0fe7":function(o,e,t){"use strict";t.r(e);var i=t("531e"),n=t("483c");for(var s in n)"default"!==s&&function(o){t.d(e,o,function(){return n[o]})}(s);t("2554");var a=t("2877"),r=Object(a["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=r.exports},2554:function(o,e,t){"use strict";var i=t("e52f"),n=t.n(i);n.a},"483c":function(o,e,t){"use strict";t.r(e);var i=t("49cb"),n=t.n(i);for(var s in i)"default"!==s&&function(o){t.d(e,o,function(){return i[o]})}(s);e["default"]=n.a},"49cb":function(o,e,t){"use strict";(function(o,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{isCheck:!0,shop_goods_num:1,id:"",address_info:"",order_id:"",couponInfo:{},couponPrice:0,couponPriceText:"",goods_total_price:0,postage:0,baoyou_price:0,freightList:[],orderInfo:"",is_paymember:0}},onLoad:function(o){var e=o.orderInfo;if(e){e=JSON.parse(e);this.orderInfo=e,this.shop_goods_num=e.shop_goods_num,this.is_paymember=this.globalData.user_info.is_paymember,this.goods_total_price=this.countTotalPrice().toFixed(2)}},methods:{onJianClick:function(){1!=this.orderInfo.shop_goods_num?(this.shop_goods_num=--this.orderInfo.shop_goods_num,this.goods_total_price=this.countTotalPrice().toFixed(2)):o.showToast({icon:"none",title:"数量不能少于1"})},onJiaClick:function(){null!=this.orderInfo?this.orderInfo.shop_goods_num!=this.orderInfo.kucun?(this.shop_goods_num=++this.orderInfo.shop_goods_num,this.goods_total_price=this.countTotalPrice().toFixed(2)):o.showToast({icon:"none",title:"当前商品库存不足"}):o.showToast({icon:"none",title:"数据加载失败"})},payEnd:function(){if(this.id=this.address_info.id,""!=this.id&&null!=this.id)if(this.isCheck){var e={user_id:this.globalData.user_info.userid,goods_num:this.orderInfo.shop_goods_num,goods_id:this.orderInfo.goods_id,address_id:this.address_info.id},t=this;this.xm_config.add_order(e).then(function(e){1==e.data.status?null!=e.data.info&&null!=e.data.info.order_id&&(t.order_id=e.data.info.order_id,t.getWxParam()):o.showToast({title:e.data.msg,icon:"none"})})}else o.showToast({title:"请选择支付方式",icon:"none"});else o.showToast({title:"请选择地址",icon:"none"})},getWxParam:function(){var e=this,t={order_id:this.order_id,payment_code:"weixinapp"};this.xm_config.weixinxcx_add_order(t).then(function(t){1==t.data.status?null!=t.data.info&&null!=t.data.info.pay_info&&e.weixinappPay(t.data.info.pay_info):o.showToast({title:t.data.msg,icon:"none"})})},weixinPay:function(e){var i=this;o.requestPayment({timeStamp:e.timeStamp+"",nonceStr:e.nonceStr,package:e.package,signType:"MD5",paySign:e.sign,success:function(e){o.redirectTo({url:"../market-pay-card-success/market-pay-card-success?order_id="+i.data.order_id})},fail:function(e){console.log(t(e," at pages\\market-card-pay\\market-card-pay.vue:271")),o.showToast({icon:"none",title:"支付失败"})}})},weixinappPay:function(e){var i=this;o.requestPayment({provider:"wxpay",orderInfo:JSON.stringify({appid:e.appid,noncestr:e.noncestr,package:e.package,partnerid:e.partnerid,prepayid:e.prepayid,timestamp:e.timestamp+"",sign:e.sign}),success:function(e){console.log(t(e," at pages\\market-card-pay\\market-card-pay.vue:296")),o.showToast({icon:"none",title:"支付成功"}),o.redirectTo({url:"../market-pay-card-success/market-pay-card-success?order_id="+i.data.order_id})},fail:function(e){console.log(t(e," at pages\\market-card-pay\\market-card-pay.vue:307")),o.showToast({icon:"none",title:"支付失败"})}})},checkboxChange:function(){this.isCheck=!this.isCheck},setAddressInfo:function(o){this.address_info={id:o.id,region_id:o.region_id,city_id:o.city_id,region_name:o.region_name,city:o.city,consignee:o.consignee,address:o.address,phone_mob:o.phone_mob,default:o.default,auto_open:o.auto_open,is_beijing:o.is_beijing}},onSelectAddressClick:function(){wx.navigateTo({url:"../address/select-address-list/select-address-list"})},countTotalPrice:function(){var o=0;return o=1==this.globalData.user_info.is_paymember?this.orderInfo.member_price*this.orderInfo.shop_goods_num:this.orderInfo.price*this.orderInfo.shop_goods_num,o}}};e.default=i}).call(this,t("6e42")["default"],t("0de9")["default"])},"531e":function(o,e,t){"use strict";var i=function(){var o=this,e=o.$createElement;o._self._c},n=[];t.d(e,"a",function(){return i}),t.d(e,"b",function(){return n})},e52f:function(o,e,t){}},[["5471","common/runtime","common/vendor"]]]);