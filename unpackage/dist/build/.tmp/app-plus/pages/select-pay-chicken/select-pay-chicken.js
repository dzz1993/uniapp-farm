(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/select-pay-chicken/select-pay-chicken"],{"2f51":function(i,t,n){"use strict";n.r(t);var e=n("ce70"),a=n("6100");for(var s in a)"default"!==s&&function(i){n.d(t,i,function(){return a[i]})}(s);n("c259");var o=n("2877"),d=Object(o["a"])(a["default"],e["a"],e["b"],!1,null,null,null);t["default"]=d.exports},"5fe3":function(i,t,n){},6100:function(i,t,n){"use strict";n.r(t);var e=n("a57d"),a=n.n(e);for(var s in e)"default"!==s&&function(i){n.d(t,i,function(){return e[i]})}(s);t["default"]=a.a},a57d:function(i,t,n){"use strict";(function(i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={data:function(){return{current_pay_num:1,disable_ticket:0,address_id:"",card_ids:"",ticket_id:"",chick_info:{},address_info:{},original_order_amount:0,reduce_money:0,pay_amount:0,isXieyiCheck:!1,set_id:0,card_info:[],coupon_info:{},headImgUrl:"",nickname:"",period_id:"",is_landowner:0}},onLoad:function(i){var t=null,n=null;this.globalData.user_info.headimgurl&&(t=this.utils.imageUrlUtils(this.globalData.user_info.headimgurl)),n=this.globalData.user_info.nickname?this.globalData.user_info.nickname:this.globalData.user_info.xcx_nick_name,this.headImgUrl=t,this.nickname=n;var e=i.period_id;this.period_id=e,1==parseFloat(this.globalData.user_info.is_landowner)?this.is_landowner=1:this.is_landowner=0,this.calc_maiji_order()},methods:{calc_maiji_order:function(){var t=this,n={user_id:this.globalData.user_info.userid,period_id:this.period_id,num:this.current_pay_num,disable_ticket:this.disable_ticket};""!=this.address_id&&null!=this.address_id&&(n.address_id=this.address_id),""!=this.card_ids&&null!=this.card_ids&&(n.card_ids=this.card_ids),""!=this.ticket_id&&null!=this.ticket_id&&(n.ticket_id=this.ticket_id),this.xm_config.calc_maiji_order(n).then(function(n){null!=n.data.info?(t.chick_info=n.data.info,t.address_id=n.data.info.address_id,t.address_info=n.data.info.address_info,t.original_order_amount=n.data.info.original_order_amount,t.reduce_money=n.data.info.reduce_money,t.pay_amount=n.data.info.pay_amount,t.set_id=n.data.info.set_id,null!=n.data.info.card_info?t.card_info=n.data.info.card_info:t.card_info={},null!=n.data.info.coupon_info?t.coupon_info=n.data.info.coupon_info:t.coupon_info={}):i.showToast({title:n.data.msg,icon:"none"})})},onJianClick:function(){1!=this.current_pay_num?(this.current_pay_num=--this.current_pay_num,this.calc_maiji_order()):i.showToast({title:"购买数量不能小于1",icon:"none"})},onJiaClick:function(){this.current_pay_num=++this.current_pay_num,this.calc_maiji_order()},onGoXieyiClick:function(){i.navigateTo({url:"../chicken_pro/chicken_pro"})},xieyiCheckboxChange:function(){this.isXieyiCheck=!this.isXieyiCheck},goCardList:function(){i.navigateTo({url:"../paycards/paycards?type=1&num="+this.current_pay_num+"&choose="+this.card_ids+"&set_id="+this.set_id})},surePay:function(){this.isXieyiCheck?""!=this.address_id&&null!=this.address_id?this.add_maiji_order():i.showToast({title:"请选择收货地址",icon:"none"}):i.showToast({title:"请先勾选购鸡协议",icon:"none"})},add_maiji_order:function(){var t=this,n={user_id:this.globalData.user_info.userid,address_id:this.address_id,period_id:this.period_id,num:this.current_pay_num,disable_ticket:this.disable_ticket};""!=this.card_ids&&null!=this.card_ids&&(n.card_ids=this.card_ids),""!=this.ticket_id&&null!=this.ticket_id&&(n.ticket_id=this.ticket_id),this.xm_config.add_maiji_order(n).then(function(n){1==n.data.status?null!=n.data.info&&(t.order_id=n.data.info.order_id,1==n.data.info.is_pay?t.getWxParam():i.redirectTo({url:"../pay-chicken-success/pay-chicken-success?order_id="+t.order_id})):i.showToast({title:n.data.msg,icon:"none"})})},getWxParam:function(){var t=this,n={order_id:this.order_id,payment_code:"weixinapp"};this.xm_config.weixinxcx_add_order(n).then(function(n){1==n.data.status?null!=n.data.info&&null!=n.data.info.pay_info&&t.weixinappPay(n.data.info.pay_info):i.showToast({title:n.data.msg,icon:"none"})})},weixinxcxPay:function(t){var e=this;i.requestPayment({provider:"wxpay",timeStamp:t.timeStamp+"",nonceStr:t.nonceStr,package:t.package,signType:"MD5",paySign:t.sign,success:function(t){i.redirectTo({url:"../pay-chicken-success/pay-chicken-success?order_id="+e.order_id})},fail:function(t){console.log(n(t," at pages\\select-pay-chicken\\select-pay-chicken.vue:441")),i.showToast({icon:"none",title:"支付失败"})}})},weixinappPay:function(t){var e=this;i.requestPayment({provider:"wxpay",orderInfo:JSON.stringify({appid:t.appid,noncestr:t.noncestr,package:t.package,partnerid:t.partnerid,prepayid:t.prepayid,timestamp:t.timestamp+"",sign:t.sign}),success:function(t){console.log(n(t," at pages\\select-pay-chicken\\select-pay-chicken.vue:468")),i.showToast({icon:"none",title:"支付成功"}),i.redirectTo({url:"../pay-chicken-success/pay-chicken-success?order_id="+e.order_id})},fail:function(t){console.log(n(t," at pages\\select-pay-chicken\\select-pay-chicken.vue:479")),i.showToast({icon:"none",title:"支付失败"})}})},setAddress:function(){i.navigateTo({url:"../address/select-address-list/select-address-list"})},setAddressInfo:function(i){null!=i&&null!=i.id&&(this.address_id=i.id),this.calc_maiji_order()},setCardData:function(i,t){if(null!=i&&0!=i.length){var n="";i.forEach(function(i){n+=i,n+=","}),n.length>0&&(n=n.substring(0,n.length-1)),this.card_ids=n,this.coupon_info={},this.ticket_id=""}else delete this.card_ids;null!=t&&(this.card_info=t),this.calc_maiji_order()},onCunponClick:function(){i.navigateTo({url:"../select-coupon-pay-field/select-coupon-pay-field?couponInfo="+JSON.stringify(this.coupon_info)+"&goodTotalPrice="+this.original_order_amount+"&coupon_type=3"})},setCunponData:function(i){null==i?(this.coupon_info={},this.disable_ticket=1,delete this.ticket_id):(this.coupon_info=i,this.ticket_id=i.id,this.disable_ticket=0),this.calc_maiji_order()}}};t.default=e}).call(this,n("6e42")["default"],n("0de9")["default"])},c259:function(i,t,n){"use strict";var e=n("5fe3"),a=n.n(e);a.a},ce70:function(i,t,n){"use strict";var e=function(){var i=this,t=i.$createElement;i._self._c},a=[];n.d(t,"a",function(){return e}),n.d(t,"b",function(){return a})}},[["9666","common/runtime","common/vendor"]]]);