(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/market-shop-car-pay/market-shop-car-pay"],{"4c32":function(i,t,e){"use strict";e.r(t);var o=e("bdcb"),s=e.n(o);for(var n in o)"default"!==n&&function(i){e.d(t,i,function(){return o[i]})}(n);t["default"]=s.a},"4c49":function(i,t,e){},"54d2":function(i,t,e){"use strict";e.r(t);var o=e("827e"),s=e("4c32");for(var n in s)"default"!==n&&function(i){e.d(t,i,function(){return s[i]})}(n);e("b5d6");var a=e("2877"),r=Object(a["a"])(s["default"],o["a"],o["b"],!1,null,null,null);t["default"]=r.exports},"827e":function(i,t,e){"use strict";var o=function(){var i=this,t=i.$createElement;i._self._c},s=[];e.d(t,"a",function(){return o}),e.d(t,"b",function(){return s})},b5d6:function(i,t,e){"use strict";var o=e("4c49"),s=e.n(o);s.a},bdcb:function(i,t,e){"use strict";(function(i,e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{shop_goods_num:1,order_id:"",goods_id_str:"",address_info:"",freight_coupon_info:"",coupon_info:"",input_content:"",is_paymember:1,use_user_money:1,disable_ticket:0,disable_freight:0,good_list:[],new_good_list:[],count_order_info:{}}},onLoad:function(i){var t=i.select_goods_list;if(t){t=JSON.parse(t);this.good_list=t}var e="";for(var o in this.good_list)e+=this.good_list[o].zd_goods_id+",";this.goods_id_str=e.substring(0,e.length-1),this.calc_order_amount()},methods:{calc_order_amount:function(){var t=this,e="";for(var o in this.good_list)e+=this.good_list[o].rec_id+",";this.rec_ids=e.substring(0,e.length-1);var s={user_id:this.globalData.user_info.userid,rec_ids:this.rec_ids};this.use_user_money&&(s.use_user_money=this.use_user_money),1==this.disable_ticket?s.disable_ticket=this.disable_ticket:this.coupon_info?(s.disable_ticket=0,s.ticket_id=this.coupon_info.id):s.disable_ticket=0,1==this.disable_freight?s.disable_freight=this.disable_freight:this.freight_coupon_info?(s.disable_freight=0,s.user_freight_id=this.freight_coupon_info.id):s.disable_freight=0,this.address_info&&this.address_info.id&&(s.address_id=this.address_info.id),this.xm_config.calc_order_amount(s).then(function(e){1==e.data.status?(t.count_order_info=e.data.info,t.address_info=e.data.info.address_info?e.data.info.address_info:"",t.coupon_info=e.data.info.coupon_info?e.data.info.coupon_info:"",t.freight_coupon_info=e.data.info.freight_coupon_info?e.data.info.freight_coupon_info:"",t.new_good_list=e.data.info.goods):i.showToast({title:e.data.msg,icon:"none"})})},onSelectCouponClick:function(){var t="";for(var e in this.good_list)t+=this.good_list[e].rec_id+",";this.rec_ids=t.substring(0,t.length-1),i.navigateTo({url:"../select-coupon/select-coupon?couponInfo="+JSON.stringify(this.coupon_info)+"&rec_ids="+this.rec_ids+"&address_id="+this.address_info.id})},onSelectFreightCouponClick:function(){i.navigateTo({url:"../select-coupon-freight/select-coupon?goodTotalPrice="+parseFloat(this.count_order_info.goods_amount).toFixed(2)+"&pt_goods="+this.goods_id_str+"&freightInfo="+JSON.stringify(this.freight_coupon_info)})},setCunponBackData:function(i){i?(this.coupon_info=i,this.disable_ticket=0):(this.coupon_info="",this.disable_ticket=1),this.calc_order_amount()},getInputContent:function(i){this.input_content=i.detail.value},setFreightBackData:function(i){i?(this.freight_coupon_info=i,this.disable_freight=0):(this.freight_coupon_info="",this.disable_freight=1),this.calc_order_amount()},onYeBoxClcik:function(){this.use_user_money=1==this.use_user_money?0:1,this.calc_order_amount()},onSelectAddressClick:function(){i.navigateTo({url:"../address/select-address-list/select-address-list"})},setAddressInfo:function(i){this.address_info={id:i.id,region_id:i.region_id,city_id:i.city_id,region_name:i.region_name,city:i.city,consignee:i.consignee,address:i.address,phone_mob:i.phone_mob,default:i.default,auto_open:i.auto_open,is_beijing:i.is_beijing},this.calc_order_amount()},payEnd:function(){var t=this;if(this.id=this.address_info.id,""!=this.id&&null!=this.id){var e="";for(var o in this.good_list)e+=this.good_list[o].rec_id+",";var s={user_id:this.globalData.user_info.userid,rec_ids:e.substring(0,e.length-1),address_id:this.address_info.id};this.use_user_money&&(s.use_user_money=this.use_user_money),1==this.disable_ticket?s.disable_ticket=this.disable_ticket:this.coupon_info?(s.disable_ticket=0,s.ticket_id=this.coupon_info.id):s.disable_ticket=0,1==this.disable_freight?s.disable_freight=this.disable_freight:this.freight_coupon_info?(s.disable_freight=0,s.user_freight_id=this.freight_coupon_info.id):s.disable_freight=0,this.input_content&&(s.remark=this.input_content),this.xm_config.add_market_order(s).then(function(e){1==e.data.status?null!=e.data.info&&null!=e.data.info.order_id&&(t.order_id=e.data.info.order_id,0==e.data.info.is_pay?(i.showToast({title:"使用余额支付成功",icon:"none"}),i.redirectTo({url:"../market-pay-success/market-pay-success?order_id="+t.order_id})):t.getWxParam()):i.showToast({title:e.data.msg,icon:"none"})})}else i.showToast({title:"请选择地址",icon:"none"})},getWxParam:function(){var t=this,e={order_id:this.order_id,payment_code:"weixinapp"};this.xm_config.weixinxcx_add_order(e).then(function(e){1==e.data.status?null!=e.data.info&&null!=e.data.info.pay_info&&t.weixinappPay(e.data.info.pay_info):i.showToast({title:e.data.msg,icon:"none"})})},weixinxcxPay:function(t){var o=this;i.requestPayment({provider:"wxpay",timeStamp:t.timeStamp+"",nonceStr:t.nonceStr,package:t.package,signType:"MD5",paySign:t.sign,success:function(t){console.log(e(t," at pages\\market-shop-car-pay\\market-shop-car-pay.vue:451")),i.showToast({icon:"none",title:"支付成功"}),i.redirectTo({url:"../market-pay-success/market-pay-success?order_id="+o.order_id})},fail:function(t){console.log(e(t," at pages\\market-shop-car-pay\\market-shop-car-pay.vue:461")),i.showToast({icon:"none",title:"支付失败"})}})},weixinappPay:function(t){var o=this;i.requestPayment({provider:"wxpay",orderInfo:JSON.stringify({appid:t.appid,noncestr:t.noncestr,package:t.package,partnerid:t.partnerid,prepayid:t.prepayid,timestamp:t.timestamp+"",sign:t.sign}),success:function(t){console.log(e(t," at pages\\market-shop-car-pay\\market-shop-car-pay.vue:488")),i.showToast({icon:"none",title:"支付成功"}),i.redirectTo({url:"../market-pay-success/market-pay-success?order_id="+o.order_id})},fail:function(t){console.log(e(t," at pages\\market-shop-car-pay\\market-shop-car-pay.vue:499")),i.showToast({icon:"none",title:"支付失败"})}})}}};t.default=o}).call(this,e("6e42")["default"],e("0de9")["default"])}},[["89e8","common/runtime","common/vendor"]]]);