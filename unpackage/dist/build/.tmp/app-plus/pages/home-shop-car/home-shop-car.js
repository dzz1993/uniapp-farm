(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home-shop-car/home-shop-car"],{3314:function(t,e,i){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{good_list:[],delBtnWidth:60,saveHidden:!0,totalPrice:0,allSelect:!1,noSelect:!0,delete_type:0,startX:0,is_paymember:1,currentShopCarIndex:0,shopCarType:0}},onLoad:function(){},onShow:function(){this.get_cart()},methods:{get_cart:function(){var e=this;if(e.globalData.user_info.userid){var i={user_id:this.globalData.user_info.userid};this.xm_config.get_cart(i).then(function(i){if(1==i.data.status){if(null!=i.data.info&&null!=i.data.info.list){for(var o in i.data.info.list)i.data.info.list[o].goods_image=e.utils.imageUrlUtils(i.data.info.list[o].goods_image);e.good_list=i.data.info.list}}else t.showToast({title:i.data.msg,icon:"none"})})}},onPullDownRefresh:function(){this.page=1,this.get_cart()},selectTap:function(t){console.log(i(this.good_list," at pages\\home-shop-car\\home-shop-car.vue:148"));t=t;var e=this.good_list;""!==t&&null!=t&&(e[parseInt(t)].active=!e[parseInt(t)].active,this.setGoodsList(this.getSaveHide(),this.totalPriceF(),this.allSelectF(),this.noSelectF(),e))},touchS:function(t){1==t.touches.length&&(console.log(i(t.touches[0].clientX," at pages\\home-shop-car\\home-shop-car.vue:160")),this.startX=t.touches[0].clientX)},touchM:function(t){var e=t.currentTarget.dataset.index;if(1==t.touches.length){var i=t.touches[0].clientX,o=this.startX-i,s=this.delBtnWidth,a="";0==o||o<0?a="margin-left:0px":o>0&&(a="margin-left:-"+o+"px",o>=s&&(a="left:-"+s+"px"));var n=this.good_list;""!=e&&null!=e&&(n[parseInt(e)].left=a,this.setGoodsList(this.getSaveHide(),this.totalPriceF(),this.allSelectF(),this.noSelectF(),n))}},touchE:function(t){var e=t.currentTarget.dataset.index;if(1==t.changedTouches.length){var i=t.changedTouches[0].clientX,o=this.startX-i,s=this.delBtnWidth,a=o>s/2?"margin-left:-"+s+"px":"margin-left:0px",n=this.good_list;""!==e&&null!=e&&(n[parseInt(e)].left=a,this.setGoodsList(this.getSaveHide(),this.totalPriceF(),this.allSelectF(),this.noSelectF(),n))}},onDeleteClick:function(){var e=this,i=this.good_list;i=i.filter(function(t){return t.active});0!=i.length?t.showModal({title:"温馨提示",content:"确定要删除吗？",success:function(t){t.confirm&&(e.delete_type=2,e.deleteShopCarItem())}}):t.showToast({title:"请选择要删除的数据",icon:"none"})},deleteShopCarItem:function(){var e=this,i={user_id:this.globalData.user_info.userid};if(1==this.delete_type){var o=this.good_list;i.rec_ids=o[parseFloat(this.delete_index)].rec_id}else{if(2!=this.delete_type)return;for(var s="",a=(o=this.good_list,o=o.filter(function(t){return t.active}),0);a<o.length;a++)s+=o[a].rec_id+",";i.rec_ids=s.substring(0,s.length)}this.xm_config.delete_cart(i).then(function(i){if(1==i.data.status){if(1==e.delete_type){var o=e.good_list;o.splice(e.delete_index,1),e.setGoodsList(e.getSaveHide(),e.totalPriceF(),e.allSelectF(),e.noSelectF(),o)}else if(2==e.delete_type){o=e.good_list;o=o.filter(function(t){return!t.active}),e.setGoodsList(e.getSaveHide(),e.totalPriceF(),e.allSelectF(),e.noSelectF(),o)}}else t.showToast({title:i.data.msg,icon:"none"})}),utils.request(xm_config.delete_cart,i,this.parseDelShopCarGoodsListData)},onJianClick:function(t,e){t=t,e=e;this.currentShopCarIndex=t,this.shopCarType=1,1!=e.quantity?this.edit_cart():wx.showToast({title:"该商品不能减少了哦"})},onJiaClick:function(t,e){t=t;this.currentShopCarIndex=t,this.shopCarType=2,this.edit_cart()},edit_cart:function(){var e=this,i=this.currentShopCarIndex,o=this.good_list[i].quantity,s={rec_id:this.good_list[i].rec_id};1==this.shopCarType&&(s.num=--o),2==this.shopCarType&&(s.num=++o),this.xm_config.edit_cart(s).then(function(i){1==i.data.status?(1==e.shopCarType&&(e.good_list[e.currentShopCarIndex].quantity--,e.setGoodsList(e.getSaveHide(),e.totalPriceF(),e.allSelectF(),e.noSelectF(),e.good_list)),2==e.shopCarType&&(e.good_list[e.currentShopCarIndex].quantity++,e.setGoodsList(e.getSaveHide(),e.totalPriceF(),e.allSelectF(),e.noSelectF(),e.good_list))):t.showToast({title:i.data.msg,icon:"none"})})},bindAllSelect:function(){var t=this.allSelect,e=this.good_list;if(t)for(var i=0;i<e.length;i++){var o=e[i];o.active=!1}else for(i=0;i<e.length;i++){o=e[i];0==o.goods_number?o.active=!1:o.active=!0}this.setGoodsList(this.getSaveHide(),this.totalPriceF(),!t,this.noSelectF(),e)},setGoodsList:function(t,e,i,o,s){this.saveHidden=t,this.good_list=s,this.totalPrice=parseFloat(e).toFixed(2),this.allSelect=i,this.noSelect=o},getSaveHide:function(){var t=this.saveHidden;return t},totalPriceF:function(){for(var t=this.good_list,e=0,i=0;i<t.length;i++){var o=t[i];o.active&&(1==o.is_now_promote?e+=parseFloat(o.promote_price)*o.quantity:1==this.is_paymember?e+=parseFloat(o.member_price)*o.quantity:e+=parseFloat(o.price)*o.quantity)}return e=parseFloat(e.toFixed(2)),e},allSelectF:function(){for(var t=this.good_list,e=!1,i=0;i<t.length;i++){var o=t[i];if(!o.active){e=!1;break}e=!0}return e},noSelectF:function(){for(var t=this.good_list,e=0,i=0;i<t.length;i++){var o=t[i];o.active||e++}return e==t.length},toPayOrder:function(){var e=this.good_list,i=e.filter(function(t){return t.active});if(0!=i.length){for(var o=0;o<i.length;o++)if(0==i[o].goods_number)return void wx.showToast({title:"您选择的商品无库存",icon:"none"});t.navigateTo({url:"../market-shop-car-pay/market-shop-car-pay?select_goods_list="+JSON.stringify(i)})}else wx.showToast({title:"请选择要结算的商品",icon:"none"})}}};e.default=o}).call(this,i("6e42")["default"],i("0de9")["default"])},"6cc0":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},s=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return s})},"7d52":function(t,e,i){},acef:function(t,e,i){"use strict";i.r(e);var o=i("6cc0"),s=i("dec4");for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);i("b2a7");var n=i("2877"),l=Object(n["a"])(s["default"],o["a"],o["b"],!1,null,null,null);e["default"]=l.exports},b2a7:function(t,e,i){"use strict";var o=i("7d52"),s=i.n(o);s.a},dec4:function(t,e,i){"use strict";i.r(e);var o=i("3314"),s=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);e["default"]=s.a}},[["4881","common/runtime","common/vendor"]]]);